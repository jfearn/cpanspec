FROM fedora:22


MAINTAINER "Jeff Fearn" <jfearn@redhat.com>

RUN useradd -ms /bin/bash cpanspec
RUN echo 'cpanspec ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers

# Install cpanspec deps
RUN dnf -y install \
  'perl(Archive::Tar)' \
  'perl(Archive::Zip)' \
  'perl(IO::Uncompress::Bunzip2)' \
  'perl(LWP::UserAgent)' \
  'perl(Module::Build)' \
  'perl(Module::CoreList)' \
  'perl(Module::ExtractUse)' \
  'perl(Parse::CPAN::Packages)' \
  'perl(Perl::Version)' \
  'perl(Pod::Simple::TextContent)' \
  'perl(Text::Autoformat)' \
  'perl(YAML)' \
  deltarpm \
  gcc \
  python-dnf-plugins-core \
  rpm \
  rpm-build \
  sudo \
  tar

RUN yum -y upgrade --skip-broken --exclude=util-linux --exclude=*.i686;

USER cpanspec
ENV HOME /home/cpanspec
WORKDIR /tmp/deps
RUN rpmdev-setuptree

